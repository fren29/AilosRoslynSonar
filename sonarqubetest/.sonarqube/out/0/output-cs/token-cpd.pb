…=
GD:\Projects\sonarqubetest\SonarQubeTest\Controllers\ClientController.cs
	namespace 	
SonarQubeTest
 
. 
Controllers #
{ 
[ 
Route 

(
 
$str 
) 
] 
[ 
ApiController 
] 
public 

class 
ClientController !
:" #
ControllerBase$ 2
{ 
private 
readonly 
SqlServerContext )
_context* 2
;2 3
public 
ClientController 
(  
SqlServerContext  0
context1 8
)8 9
{ 	
_context 
= 
context 
; 
} 	
[ 	
HttpGet	 
] 
public 
async 
Task 
< 
ActionResult &
<& '
IEnumerable' 2
<2 3
Client3 9
>9 :
>: ;
>; <
ListClients= H
(H I
)I J
{ 	
if
 
( 
_context 
. 
Clients 
== !
null" &
)& '
{
 
return 
NotFound 
( 
) 
;  
}  
 
return!! 
await!! 
_context!! !
.!!! "
Clients!!" )
.!!) *
ToListAsync!!* 5
(!!5 6
)!!6 7
;!!7 8
}"" 	
[%% 	
HttpGet%%	 
(%% 
$str%% 
)%% 
]%% 
public&& 
async&& 
Task&& 
<&& 
ActionResult&& &
<&&& '
Client&&' -
>&&- .
>&&. /
	GetClient&&0 9
(&&9 :
int&&: =
id&&> @
)&&@ A
{'' 	
if((
 
((( 
_context(( 
.(( 
Clients(( 
==(( !
null((" &
)((& '
{))
 
return** 
NotFound** 
(** 
)** 
;**  
}++
 
var,, 
client,, 
=,, 
await,, 
_context,, '
.,,' (
Clients,,( /
.,,/ 0
	FindAsync,,0 9
(,,9 :
id,,: <
),,< =
;,,= >
if.. 
(.. 
client.. 
==.. 
null.. 
).. 
{// 
return00 
NotFound00 
(00  
)00  !
;00! "
}11 
return33 
client33 
;33 
}44 	
[88 	
HttpPut88	 
(88 
$str88 
)88 
]88 
public99 
async99 
Task99 
<99 
IActionResult99 '
>99' (
	PutClient99) 2
(992 3
int993 6
id997 9
,999 :
Client99; A
client99B H
)99H I
{:: 	
if;; 
(;; 
id;; 
!=;; 
client;; 
.;; 
Id;; 
);;  
{<< 
return== 

BadRequest== !
(==! "
)==" #
;==# $
}>> 
_context@@ 
.@@ 
Entry@@ 
(@@ 
client@@ !
)@@! "
.@@" #
State@@# (
=@@) *
EntityState@@+ 6
.@@6 7
Modified@@7 ?
;@@? @
tryBB 
{CC 
awaitDD 
_contextDD 
.DD 
SaveChangesAsyncDD /
(DD/ 0
)DD0 1
;DD1 2
}EE 
catchFF 
(FF (
DbUpdateConcurrencyExceptionFF /
)FF/ 0
{GG 
ifHH 
(HH 
!HH 
ClientExistsHH !
(HH! "
idHH" $
)HH$ %
)HH% &
{II 
returnJJ 
NotFoundJJ #
(JJ# $
)JJ$ %
;JJ% &
}KK 
elseLL 
{MM 
throwNN 
;NN 
}OO 
}PP 
returnRR 
	NoContentRR 
(RR 
)RR 
;RR 
}SS 	
[WW 	#
ExcludeFromCodeCoverageWW	  
]WW  !
[XX 	
HttpPostXX	 
]XX 
publicYY 
asyncYY 
TaskYY 
<YY 
ActionResultYY &
<YY& '
ClientYY' -
>YY- .
>YY. /
IncludeClientYY0 =
(YY= >
ClientYY> D
clientYYE K
)YYK L
{ZZ 	
if[[
 
([[ 
_context[[ 
.[[ 
Clients[[ 
==[[ !
null[[" &
)[[& '
{\\
 
return]] 
Problem]] 
(]] 
$str]] N
)]]N O
;]]O P
}^^
 
var`` 
test`` 
=`` 
$str`` 
;`` 
ifaa 
(aa 
trueaa 
)aa 
testbb 
=bb 
$strbb %
;bb% &
_contextdd 
.dd 
Clientsdd 
.dd 
Adddd  
(dd  !
clientdd! '
)dd' (
;dd( )
awaitee 
_contextee 
.ee 
SaveChangesAsyncee +
(ee+ ,
)ee, -
;ee- .
returngg 
CreatedAtActiongg "
(gg" #
$strgg# .
,gg. /
newgg0 3
{gg4 5
idgg6 8
=gg9 :
clientgg; A
.ggA B
IdggB D
}ggE F
,ggF G
clientggH N
)ggN O
;ggO P
}hh 	
[kk 	

HttpDeletekk	 
(kk 
$strkk 
)kk 
]kk 
publicll 
asyncll 
Taskll 
<ll 
IActionResultll '
>ll' (
ExcludeClientll) 6
(ll6 7
intll7 :
idll; =
)ll= >
{mm 	
ifnn 
(nn 
_contextnn 
.nn 
Clientsnn  
==nn! #
nullnn$ (
)nn( )
{oo 
returnpp 
NotFoundpp 
(pp  
)pp  !
;pp! "
}qq 
varrr 
clientrr 
=rr 
awaitrr 
_contextrr '
.rr' (
Clientsrr( /
.rr/ 0
	FindAsyncrr0 9
(rr9 :
idrr: <
)rr< =
;rr= >
ifss 
(ss 
clientss 
==ss 
nullss 
)ss 
{tt 
returnuu 
NotFounduu 
(uu  
)uu  !
;uu! "
}vv 
_contextxx 
.xx 
Clientsxx 
.xx 
Removexx #
(xx# $
clientxx$ *
)xx* +
;xx+ ,
awaityy 
_contextyy 
.yy 
SaveChangesAsyncyy +
(yy+ ,
)yy, -
;yy- .
return{{ 
	NoContent{{ 
({{ 
){{ 
;{{ 
}|| 	
private~~ 
bool~~ 
ClientExists~~ !
(~~! "
int~~" %
id~~& (
)~~( )
{ 	
return
€€ 
(
€€ 
_context
€€ 
.
€€ 
Clients
€€ $
?
€€$ %
.
€€% &
Any
€€& )
(
€€) *
e
€€* +
=>
€€, .
e
€€/ 0
.
€€0 1
Id
€€1 3
==
€€4 6
id
€€7 9
)
€€9 :
)
€€: ;
.
€€; <
GetValueOrDefault
€€< M
(
€€M N
)
€€N O
;
€€O P
}
 	
}
‚‚ 
}ƒƒ µ
AD:\Projects\sonarqubetest\SonarQubeTest\Domain\Entities\Client.cs
	namespace 	
SonarQubeTest
 
. 
Domain 
. 
Entities '
{ 
public 

class 
Client 
{ 
public 
int 
Id 
{ 
get 
; 
set  
;  !
}" #
public 
string 
? 
Name 
{ 
get !
;! "
set# &
;& '
}( )
public 
string 
? 
CPF 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
? 
Rate 
{ 
get !
;! "
set# &
;& '
}( )
}		 
}

 á
ID:\Projects\sonarqubetest\SonarQubeTest\Infra\Context\SqlServerContext.cs
	namespace 	
SonarQubeTest
 
. 
Infra 
. 
Context %
{ 
public 

class 
SqlServerContext !
:" #
	DbContext$ -
{ 
public 
SqlServerContext 
(  !
DbContextOptions! 1
<1 2
SqlServerContext2 B
>B C
optionsD K
)K L
:		 
base		 
(		 
options		 
)		 
{

 	
} 	
public 
DbSet 
< 
Client 
> 
Clients $
{% &
get' *
;* +
set, /
;/ 0
}1 2
} 
}  
LD:\Projects\sonarqubetest\SonarQubeTest\Migrations\20230709235620_Initial.cs
	namespace 	
SonarQubeTest
 
. 

Migrations "
{ 
public 

partial 
class 
Initial  
:! "
	Migration# ,
{		 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str 
,  
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
trueQ U
)U V
,V W
CPF 
= 
table 
.  
Column  &
<& '
string' -
>- .
(. /
type/ 3
:3 4
$str5 D
,D E
nullableF N
:N O
trueP T
)T U
,U V
Rate 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
nullableG O
:O P
trueQ U
)U V
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 1
,1 2
x3 4
=>5 7
x8 9
.9 :
Id: <
)< =
;= >
} 
) 
; 
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder   
.   
	DropTable   &
(  & '
name!! 
:!! 
$str!! 
)!!  
;!!  !
}"" 	
}## 
}$$ ä
2D:\Projects\sonarqubetest\SonarQubeTest\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1
builder 
. 
Services 
. 
AddControllers 
(  
)  !
;! "
builder		 
.		 
Services		 
.		 
AddDbContext		 
<		 
SqlServerContext		 .
>		. /
(		/ 0
options		0 7
=>		8 :
options

 
.

 
UseSqlServer

 
(

 
builder

  
.

  !
Configuration

! .
.

. /
GetConnectionString

/ B
(

B C
$str

C [
)

[ \
??

] _
throw

` e
new

f i&
InvalidOperationException	

j ƒ
(


ƒ „
$str


„ »
)


» ¼
)


¼ ½
)


½ ¾
;


¾ ¿
builder 
. 
Services 
. #
AddEndpointsApiExplorer (
(( )
)) *
;* +
builder 
. 
Services 
. 
AddSwaggerGen 
( 
)  
;  !
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 
if 
( 
app 
. 
Environment 
. 
IsDevelopment !
(! "
)" #
)# $
{ 
app 
. 

UseSwagger 
( 
) 
; 
app 
. 
UseSwaggerUI 
( 
) 
; 
} 
app 
. 
UseHttpsRedirection 
( 
) 
; 
app 
. 
UseAuthorization 
( 
) 
; 
app 
. 
MapControllers 
( 
) 
; 
app 
. 
Run 
( 
) 	
;	 
